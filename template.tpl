___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
   "categories": [
    "CHAT",
    "LEAD_GENERATION",
    "SOCIAL"
  ],
  "securityGroups": [],
  "displayName": "Whatsapp Chat Icon",
  "brand": {
    "id": "brand_Suagencia",
    "displayName": "Suagencia",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "Include a floating whatsapp link into your webpage, so people can initiate a conversation with your business",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "GROUP",
    "name": "whatsLink",
    "displayName": "Whatsapp Link",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "RADIO",
        "name": "linkType",
        "displayName": "Link type",
        "radioItems": [
          {
            "value": "standard",
            "displayValue": "Whatsapp standard message"
          },
          {
            "value": "custom",
            "displayValue": "Custom URL"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "standard"
      },
      {
        "type": "TEXT",
        "name": "phoneNumber",
        "displayName": "Phone Number",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "POSITIVE_NUMBER"
          }
        ],
        "enablingConditions": [
          {
            "paramName": "linkType",
            "paramValue": "standard",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "textMessage",
        "displayName": "Text Message",
        "simpleValueType": true,
        "valueValidators": [],
        "enablingConditions": [
          {
            "paramName": "linkType",
            "paramValue": "standard",
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "url",
        "displayName": "link URL",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "linkType",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ],
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      }
    ]
  },
  {
    "type": "SELECT",
    "name": "position",
    "displayName": "Position",
    "macrosInSelect": true,
    "selectItems": [
      {
        "value": "top-left",
        "displayValue": "Top / Left"
      },
      {
        "value": "top-right",
        "displayValue": "Top / Right"
      },
      {
        "value": "bottom-right",
        "displayValue": "Bottom / Right"
      },
      {
        "value": "bottom-left",
        "displayValue": "Bottom / Left"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "bottom-right",
    "valueValidators": [
      {
        "type": "REGEX",
        "args": [
          "^(top|bottom)\\-(left|right)$"
        ]
      }
    ]
  },
  {
    "type": "SELECT",
    "name": "size",
    "displayName": "Size",
    "macrosInSelect": true,
    "selectItems": [
      {
        "value": "small",
        "displayValue": "Small"
      },
      {
        "value": "medium",
        "displayValue": "Medium"
      },
      {
        "value": "large",
        "displayValue": "Large"
      },
      {
        "value": "xlarge",
        "displayValue": "Extra Large"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "medium"
  },
  {
    "type": "CHECKBOX",
    "name": "shake",
    "checkboxText": "Shake Icon to draw attention",
    "simpleValueType": true
  },
  {
    "type": "CHECKBOX",
    "name": "customEvent",
    "checkboxText": "Trigger GTM Custom Event when clicked",
    "simpleValueType": true,
    "defaultValue": false
  },
  {
    "type": "TEXT",
    "name": "eventName",
    "displayName": "Custom Event Name",
    "simpleValueType": true,
    "enablingConditions": [
      {
        "paramName": "customEvent",
        "paramValue": true,
        "type": "EQUALS"
      }
    ],
    "defaultValue": "whatsapp.clicked"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const log = require('logToConsole');
const injectScript = require('injectScript');
const callInWindow = require('callInWindow');
const encodeUriComponent = require('encodeUriComponent');
log('waicon data =', data);


const options = { size:data.size, position: data.position, shake:data.shake, customEvent: data.customEvent };
let url = "";

if( data.linkType == "standard" )
{
  url = "https://wa.me/" + data.phoneNumber;
  if( data.textMessage !== undefined && data.textMessage !== "" ) {
      url += "?text=" + encodeUriComponent(data.textMessage); 
  }
} else {
  url = data.url; 
}

if( data.customEvent ) {
  options.eventName = data.eventName;
}

options.url = url;

const successLoad = function(){
  // Call data.gtmOnSuccess when the tag is finished.   
    callInWindow('suagenciaTagsWhatsapp',options);
    data.gtmOnSuccess();
  
};

const failLoad = function () {
  log("loading fail");
  data.gtmOnFailure();
};

injectScript('https://tags.suagencia.online/whatsapp/script.js', successLoad, failLoad);


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://tags.suagencia.online/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "suagenciaTagsWhatsapp"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 12/16/2022, 6:12:48 PM


